"use strict";var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var SoupType,htmlparser=createCommonjsModule((function(t,e){!function(){function runningInNode(){return"function"==typeof commonjsRequire&&"string"==typeof __filename&&"string"==typeof __dirname}var t=runningInNode()?commonjsGlobal:window;if(!runningInNode()){if(t.Tautologistics){if(t.Tautologistics.NodeHtmlParser)return}else t.Tautologistics={};t.Tautologistics.NodeHtmlParser=e}var n,r,i,s={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag"};function Parser(t,e){this._options=e||{},null==this._options.includeLocation&&(this._options.includeLocation=!1),this.validateHandler(t),this._handler=t,this.reset()}function RssHandler(t){RssHandler.super_.call(this,t,{ignoreWhitespace:!0,verbose:!1,enforceEmptyTags:!1})}function DefaultHandler(t,e){this.reset(),this._options=e||{},null==this._options.ignoreWhitespace&&(this._options.ignoreWhitespace=!1),null==this._options.verbose&&(this._options.verbose=!0),null==this._options.enforceEmptyTags&&(this._options.enforceEmptyTags=!0),"function"==typeof t&&(this._callback=t)}Parser._reTrim=/(^\s+|\s+$)/g,Parser._reTrimComment=/(^\!--|--$)/g,Parser._reWhitespace=/\s/g,Parser._reTagName=/^\s*(\/?)\s*([^\s\/]+)/,Parser._reAttrib=/([^=<>\"\'\s]+)\s*=\s*"([^"]*)"|([^=<>\"\'\s]+)\s*=\s*'([^']*)'|([^=<>\"\'\s]+)\s*=\s*([^'"\s]+)|([^=<>\"\'\s\/]+)/g,Parser._reTags=/[\<\>]/g,Parser.prototype.parseComplete=function(t){this.reset(),this.parseChunk(t),this.done()},Parser.prototype.parseChunk=function(t){this._done&&this.handleError(new Error("Attempted to parse chunk after parsing already done")),this._buffer+=t,this.parseTags()},Parser.prototype.done=function(){if(!this._done){if(this._done=!0,this._buffer.length){var t=this._buffer;this._buffer="";var e={raw:t,data:this._parseState==s.Text?t:t.replace(Parser._reTrim,""),type:this._parseState};this._parseState!=s.Tag&&this._parseState!=s.Script&&this._parseState!=s.Style||(e.name=this.parseTagName(e.data)),this.parseAttribs(e),this._elements.push(e)}this.writeHandler(),this._handler.done()}},Parser.prototype.reset=function(){this._buffer="",this._done=!1,this._elements=[],this._elementsCurrent=0,this._current=0,this._next=0,this._location={row:0,col:0,charOffset:0,inBuffer:0},this._parseState=s.Text,this._prevTagSep="",this._tagStack=[],this._handler.reset()},Parser.prototype._options=null,Parser.prototype._handler=null,Parser.prototype._buffer=null,Parser.prototype._done=!1,Parser.prototype._elements=null,Parser.prototype._elementsCurrent=0,Parser.prototype._current=0,Parser.prototype._next=0,Parser.prototype._location=null,Parser.prototype._parseState=s.Text,Parser.prototype._prevTagSep="",Parser.prototype._tagStack=null,Parser.prototype.parseTagAttribs=function(t){for(var e=t.length,n=0;n<e;){var r=t[n++];r.type!=s.Tag&&r.type!=s.Script&&r.type!=s.style||this.parseAttribs(r)}return t},Parser.prototype.parseAttribs=function(t){if(t.type==s.Script||t.type==s.Style||t.type==s.Tag){var e,n=t.data.split(Parser._reWhitespace,1)[0],r=t.data.substring(n.length);if(!(r.length<1))for(Parser._reAttrib.lastIndex=0;e=Parser._reAttrib.exec(r);)null==t.attribs&&(t.attribs={}),"string"==typeof e[1]&&e[1].length?t.attribs[e[1]]=e[2]:"string"==typeof e[3]&&e[3].length?t.attribs[e[3].toString()]=e[4].toString():"string"==typeof e[5]&&e[5].length?t.attribs[e[5]]=e[6]:"string"==typeof e[7]&&e[7].length&&(t.attribs[e[7]]=e[7])}},Parser.prototype.parseTagName=function(t){if(null==t||""==t)return"";var e=Parser._reTagName.exec(t);return e?(e[1]?"/":"")+e[2]:""},Parser.prototype.parseTags=function(){for(var t=this._buffer.length-1;Parser._reTags.test(this._buffer);){this._next=Parser._reTags.lastIndex-1;var e=this._buffer.charAt(this._next),n=this._buffer.substring(this._current,this._next),r={raw:n,data:this._parseState==s.Text?n:n.replace(Parser._reTrim,""),type:this._parseState},i=this.parseTagName(r.data);if(this._tagStack.length)if(this._tagStack[this._tagStack.length-1]==s.Script){if("/script"==i.toLowerCase())this._tagStack.pop();else if(0!=r.raw.indexOf("!--"))if(r.type=s.Text,this._elements.length&&this._elements[this._elements.length-1].type==s.Text)(a=this._elements[this._elements.length-1]).raw=a.data=a.raw+this._prevTagSep+r.raw,r.raw=r.data=""}else if(this._tagStack[this._tagStack.length-1]==s.Style){if("/style"==i.toLowerCase())this._tagStack.pop();else if(0!=r.raw.indexOf("!--"))if(r.type=s.Text,this._elements.length&&this._elements[this._elements.length-1].type==s.Text){var a=this._elements[this._elements.length-1];""!=r.raw?(a.raw=a.data=a.raw+this._prevTagSep+r.raw,r.raw=r.data=""):a.raw=a.data=a.raw+this._prevTagSep}else""!=r.raw&&(r.raw=r.data=r.raw)}else if(this._tagStack[this._tagStack.length-1]==s.Comment){var l=r.raw.length;if("-"==r.raw.charAt(l-2)&&"-"==r.raw.charAt(l-1)&&">"==e)if(this._tagStack.pop(),this._elements.length&&this._elements[this._elements.length-1].type==s.Comment)(a=this._elements[this._elements.length-1]).raw=a.data=(a.raw+r.raw).replace(Parser._reTrimComment,""),r.raw=r.data="",r.type=s.Text;else r.type=s.Comment;else if(r.type=s.Comment,this._elements.length&&this._elements[this._elements.length-1].type==s.Comment)(a=this._elements[this._elements.length-1]).raw=a.data=a.raw+r.raw+e,r.raw=r.data="",r.type=s.Text;else r.raw=r.data=r.raw+e}if(r.type==s.Tag){r.name=i;var o=i.toLowerCase();if(0==r.raw.indexOf("!--")){r.type=s.Comment,delete r.name;l=r.raw.length;"-"==r.raw.charAt(l-1)&&"-"==r.raw.charAt(l-2)&&">"==e?r.raw=r.data=r.raw.replace(Parser._reTrimComment,""):(r.raw+=e,this._tagStack.push(s.Comment))}else 0==r.raw.indexOf("!")||0==r.raw.indexOf("?")?r.type=s.Directive:"script"==o?(r.type=s.Script,"/"!=r.data.charAt(r.data.length-1)&&this._tagStack.push(s.Script)):"/script"==o?r.type=s.Script:"style"==o?(r.type=s.Style,"/"!=r.data.charAt(r.data.length-1)&&this._tagStack.push(s.Style)):"/style"==o&&(r.type=s.Style);r.name&&"/"==r.name.charAt(0)&&(r.data=r.name)}""==r.raw&&r.type==s.Text||(this._options.includeLocation&&!r.location&&(r.location=this.getLocation(r.type==s.Tag)),this.parseAttribs(r),this._elements.push(r),r.type!=s.Text&&r.type!=s.Comment&&r.type!=s.Directive&&"/"==r.data.charAt(r.data.length-1)&&this._elements.push({raw:"/"+r.name,data:"/"+r.name,name:"/"+r.name,type:r.type})),this._parseState="<"==e?s.Tag:s.Text,this._current=this._next+1,this._prevTagSep=e}this._options.includeLocation&&(this.getLocation(),this._location.row+=this._location.inBuffer,this._location.inBuffer=0,this._location.charOffset=0),this._buffer=this._current<=t?this._buffer.substring(this._current):"",this._current=0,this.writeHandler()},Parser.prototype.getLocation=function(t){for(var e,n=this._location,r=this._current-(t?1:0),i=t&&0==n.charOffset&&0==this._current;n.charOffset<r;n.charOffset++)"\n"==(e=this._buffer.charAt(n.charOffset))?(n.inBuffer++,n.col=0):"\r"!=e&&n.col++;return{line:n.row+n.inBuffer+1,col:n.col+(i?0:1)}},Parser.prototype.validateHandler=function(t){if("object"!=typeof t)throw new Error("Handler is not an object");if("function"!=typeof t.reset)throw new Error("Handler method 'reset' is invalid");if("function"!=typeof t.done)throw new Error("Handler method 'done' is invalid");if("function"!=typeof t.writeTag)throw new Error("Handler method 'writeTag' is invalid");if("function"!=typeof t.writeText)throw new Error("Handler method 'writeText' is invalid");if("function"!=typeof t.writeComment)throw new Error("Handler method 'writeComment' is invalid");if("function"!=typeof t.writeDirective)throw new Error("Handler method 'writeDirective' is invalid")},Parser.prototype.writeHandler=function(t){if(t=!!t,!this._tagStack.length||t)for(;this._elements.length;){var e=this._elements.shift();switch(e.type){case s.Comment:this._handler.writeComment(e);break;case s.Directive:this._handler.writeDirective(e);break;case s.Text:this._handler.writeText(e);break;default:this._handler.writeTag(e)}}},Parser.prototype.handleError=function(t){if("function"!=typeof this._handler.error)throw t;this._handler.error(t)},n=RssHandler,(i=function(){}).prototype=(r=DefaultHandler).prototype,n.super_=r,n.prototype=new i,n.prototype.constructor=n,RssHandler.prototype.done=function(){var t,e={},n=a.getElementsByTagName((function(t){return"rss"==t||"feed"==t}),this.dom,!1);if(n.length&&(t=n[0]),t){if("rss"==t.name){e.type="rss",t=t.children[0],e.id="";try{e.title=a.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{e.link=a.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(t){}try{e.description=a.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(t){}try{e.updated=new Date(a.getElementsByTagName("lastBuildDate",t.children,!1)[0].children[0].data)}catch(t){}try{e.author=a.getElementsByTagName("managingEditor",t.children,!1)[0].children[0].data}catch(t){}e.items=[],a.getElementsByTagName("item",t.children).forEach((function(t,n,r){var i={};try{i.id=a.getElementsByTagName("guid",t.children,!1)[0].children[0].data}catch(t){}try{i.title=a.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{i.link=a.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(t){}try{i.description=a.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(t){}try{i.pubDate=new Date(a.getElementsByTagName("pubDate",t.children,!1)[0].children[0].data)}catch(t){}e.items.push(i)}))}else{e.type="atom";try{e.id=a.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(t){}try{e.title=a.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{e.link=a.getElementsByTagName("link",t.children,!1)[0].attribs.href}catch(t){}try{e.description=a.getElementsByTagName("subtitle",t.children,!1)[0].children[0].data}catch(t){}try{e.updated=new Date(a.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(t){}try{e.author=a.getElementsByTagName("email",t.children,!0)[0].children[0].data}catch(t){}e.items=[],a.getElementsByTagName("entry",t.children).forEach((function(t,n,r){var i={};try{i.id=a.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(t){}try{i.title=a.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{i.link=a.getElementsByTagName("link",t.children,!1)[0].attribs.href}catch(t){}try{i.description=a.getElementsByTagName("summary",t.children,!1)[0].children[0].data}catch(t){}try{i.pubDate=new Date(a.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(t){}e.items.push(i)}))}this.dom=e}RssHandler.super_.prototype.done.call(this)},DefaultHandler._emptyTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1},DefaultHandler.reWhitespace=/^\s*$/,DefaultHandler.prototype.dom=null,DefaultHandler.prototype.reset=function(){this.dom=[],this._done=!1,this._tagStack=[],this._tagStack.last=function(){return this.length?this[this.length-1]:null}},DefaultHandler.prototype.done=function(){this._done=!0,this.handleCallback(null)},DefaultHandler.prototype.writeTag=function(t){this.handleElement(t)},DefaultHandler.prototype.writeText=function(t){this._options.ignoreWhitespace&&DefaultHandler.reWhitespace.test(t.data)||this.handleElement(t)},DefaultHandler.prototype.writeComment=function(t){this.handleElement(t)},DefaultHandler.prototype.writeDirective=function(t){this.handleElement(t)},DefaultHandler.prototype.error=function(t){this.handleCallback(t)},DefaultHandler.prototype._options=null,DefaultHandler.prototype._callback=null,DefaultHandler.prototype._done=!1,DefaultHandler.prototype._tagStack=null,DefaultHandler.prototype.handleCallback=function(t){if("function"==typeof this._callback)this._callback(t,this.dom);else if(t)throw t},DefaultHandler.prototype.isEmptyTag=function(t){var e=t.name.toLowerCase();return"/"==e.charAt(0)&&(e=e.substring(1)),this._options.enforceEmptyTags&&!!DefaultHandler._emptyTags[e]},DefaultHandler.prototype.handleElement=function(t){if(this._done&&this.handleCallback(new Error("Writing to the handler after done() called is not allowed without a reset()")),this._options.verbose||(delete t.raw,"tag"!=t.type&&"script"!=t.type&&"style"!=t.type||delete t.data),this._tagStack.last())if(t.type!=s.Text&&t.type!=s.Comment&&t.type!=s.Directive)if("/"==t.name.charAt(0)){var e=t.name.substring(1);if(!this.isEmptyTag(t)){for(var n=this._tagStack.length-1;n>-1&&this._tagStack[n--].name!=e;);if(n>-1||this._tagStack[0].name==e)for(;n<this._tagStack.length-1;)this._tagStack.pop()}}else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(t),this.isEmptyTag(t)||this._tagStack.push(t);else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(t);else t.type!=s.Text&&t.type!=s.Comment&&t.type!=s.Directive?"/"!=t.name.charAt(0)&&(this.dom.push(t),this.isEmptyTag(t)||this._tagStack.push(t)):this.dom.push(t)};var a={testElement:function(t,e){if(!e)return!1;for(var n in t)if("tag_name"==n){if("tag"!=e.type&&"script"!=e.type&&"style"!=e.type)return!1;if(!t.tag_name(e.name))return!1}else if("tag_type"==n){if(!t.tag_type(e.type))return!1}else if("tag_contains"==n){if("text"!=e.type&&"comment"!=e.type&&"directive"!=e.type)return!1;if(!t.tag_contains(e.data))return!1}else if(!e.attribs||!t[n](e.attribs[n]))return!1;return!0},getElements:function(t,e,n,r){if(n=null==n||!!n,r=isNaN(parseInt(r))?-1:parseInt(r),!e)return[];var i,s=[];function getTest(t){return function(e){return e==t}}for(var l in t)"function"!=typeof t[l]&&(t[l]=getTest(t[l]));if(a.testElement(t,e)&&s.push(e),r>=0&&s.length>=r)return s;if(n&&e.children)i=e.children;else{if(!(e instanceof Array))return s;i=e}for(var o=0;o<i.length&&(s=s.concat(a.getElements(t,i[o],n,r)),!(r>=0&&s.length>=r));o++);return s},getElementById:function(t,e,n){var r=a.getElements({id:t},e,n,1);return r.length?r[0]:null},getElementsByTagName:function(t,e,n,r){return a.getElements({tag_name:t},e,n,r)},getElementsByTagType:function(t,e,n,r){return a.getElements({tag_type:t},e,n,r)}};e.Parser=Parser,e.DefaultHandler=DefaultHandler,e.RssHandler=RssHandler,e.ElementType=s,e.DomUtils=a}()}));htmlparser.Parser,htmlparser.DefaultHandler,htmlparser.RssHandler,htmlparser.ElementType,htmlparser.DomUtils,function(t){t.Soup="soup",t.Tag="tag",t.Text="text",t.Comment="comment",t.Directive="directive"}(SoupType||(SoupType={}));class SoupStrainer{constructor(t){this.name=t.name,this.attrs=t.attrs,this.string=t.string,this.filter=t.filter}match(t){return this.matchItem(t.name,this.name)&&this.matchAttrs(t.attrs,this.attrs)&&this.matchString(t,this.string)&&this.matchFilter(t)?t:null}matchItem(t,e){return null==e||null==e||(Array.isArray(e)?e.some((e=>e==t)):e instanceof RegExp?e.test(t):t==e)}matchAttrs(t,e){var n;if(null==e||null==e)return!0;if(null==t||null==t)return!1;let r=!0;for(const i in e){const s=null===(n=t[i])||void 0===n?void 0:n.split(" ");if(null==s||null==s){r=!1;break}if(!s.some((t=>this.matchItem(t,e[i])))){r=!1;break}}return r}matchString(t,e){return null==e||null==e||(t.type==SoupType.Tag?!!t.string&&this.matchItem(t.string.toString(),e):this.matchItem(t.toString(),e))}matchFilter(t){return null==this.filter||null==this.filter||this.filter(t)}}class SoupElement{constructor(t,e,n){this.parent=t,this.previousElement=e,this.nextElement=n}get descendants(){const t=[];let e=this.nextElement;for(;e;){let n=e.parent;for(;n&&n!=this;)n=n.parent;if(!n)break;t.push(e),e=e.nextElement}return t}get string(){let t,e=this;if(e&&e.contents){if(1==e.contents.length){for(;e&&e.contents&&1==e.contents.length;)t=e.contents[0],e=e.contents[0];if(!t||t.type==SoupType.Tag)return;return t}{const t=e.contents.filter((t=>t.type==SoupType.Text));if(t&&1==t.length)return t[0]}}}get nextSibling(){if(!this.parent)return;const t=this.parent.contents.indexOf(this);return t!=this.parent.contents.length-1?this.parent.contents[t+1]:void 0}get previousSibling(){if(!this.parent)return;const t=this.parent.contents.indexOf(this);return 0!=t?this.parent.contents[t-1]:void 0}get nextSiblings(){if(!this.parent)return;const t=this.parent.contents.indexOf(this);return t!=this.parent.contents.length-1?this.parent.contents.slice(t+1):void 0}get previousSiblings(){if(!this.parent)return;const t=this.parent.contents.indexOf(this);return 0!=t?this.parent.contents.slice(0,t):void 0}findNextSibling(t){const e=this.findNextSiblings(Object.assign(Object.assign({},t),{limit:1}));if(e.length>0)return e[0]}findNextSiblings(t){const e=[];let n=this.nextSibling;const r=new SoupStrainer(t);for(;n;){if(n instanceof SoupElement){const i=r.match(n);if(i&&(e.push(i),t.limit&&e.length>=t.limit))break}n=n.nextSibling}return e}findPreviousSibling(t){const e=this.findPreviousSiblings(Object.assign(Object.assign({},t),{limit:1}));if(e.length>0)return e[0]}findPreviousSiblings(t){const e=[];let n=this.previousSibling;const r=new SoupStrainer(t);for(;n;){if(n instanceof SoupElement){const i=r.match(n);if(i&&(e.push(i),t.limit&&e.length>=t.limit))break}n=n.previousSibling}return e}append(t){if(null==t)throw"Cannot append null element!";if(t===this)throw"Cannot add one itself!";if(this.type!=SoupType.Tag)throw"append is not support in "+this.constructor.name}insert(t,e){if(null==e)throw"Cannot insert null element!";if(e===this)throw"Cannot add one itself!";if(this.type!=SoupType.Tag)throw"insert is not support in "+this.constructor.name;if(t<0)throw"index cannot be negative!"}extract(){let t=this;const e=this.descendants;e&&e.length&&(t=e[e.length-1]);const n=this.previousElement,r=t.nextElement;if(this.previousElement=null,t.nextElement=null,n&&(n.nextElement=r),r&&(r.previousElement=n),this.parent){const t=this.parent.contents.indexOf(this);t>=0&&this.parent.contents.splice(t,1)}return this.parent=null,this}replaceWith(t){if(null==this.parent)throw"Cannot replace element without parent!";if(t===this)return;if(t===this.parent)throw"Cannot replace element with its parent!";let e=this.parent,n=this.parent.contents.indexOf(this);this.extract();try{e.insert(n,t)}catch(t){throw"Cannot replace this element!"}return this}convertAttrsToString(){let t="";if(!this.attrs)return t;for(const e in this.attrs)Array.isArray(this.attrs[e])?t+=e+'="'+this.attrs[e].join(" ")+'" ':t+=e+'="'+this.attrs[e]+'" ';return t=t.trim(),t}isEmptyElement(){return this.contents&&0==this.contents.length}_prettify(t,e,n=0){let r="";if(this.hidden&&0==n&&--n,!this.hidden){const e=this.convertAttrsToString();r+=e?t.repeat(n)+"<"+this.name+" "+e:t.repeat(n)+"<"+this.name}if(!this.hidden){if(this.isEmptyElement()&&this.builder.canBeEmptyElement(this.name))return r+=" />"+e,r;r+=">"+e}for(let i=0;i<this.contents.length;++i)if(this.contents[i].type==SoupType.Text){let s=this.contents[i].toString();s=s.trim(),0!=s.length&&("\n"==s.substring(s.length-1)?r+=t.repeat(n+1)+s:r+=t.repeat(n+1)+s+e)}else this.contents[i].type==SoupType.Comment?r+=t.repeat(n+1)+"\x3c!--"+this.contents[i].text+"--\x3e"+e:r+=this.contents[i]._prettify(t,e,n+1);return this.hidden||(r+=t.repeat(n)+"</"+this.name+">"+e),r}prettify(t=" ",e="\n"){return this._prettify(t,e).trim()}getText(t=""){const e=[],n=this.descendants;for(let t=0;t<n.length;++t)n[t].type==SoupType.Text&&e.push(n[t].text);return e.join(t)}}class SoupComment extends SoupElement{constructor(t,e,n,r){super(e,n,r),this.text=t,this.type=SoupType.Comment}}class SoupString extends SoupElement{constructor(t,e,n,r){super(e,n,r),this.text=t,this.type=SoupType.Text}}SoupString.prototype.toString=function(){return this.text};class SoupDoctypeString extends SoupString{constructor(t,e,n,r){super(t,e,n,r),this.type=SoupType.Directive}}SoupDoctypeString.prototype.toString=function(){return"<"+this.text+">"};class SoupTag extends SoupElement{constructor(t,e,n=null,r,i,s){super(r,i,s),this.name=t,this.contents=[],this.attrs=n||{},this.hidden=!1,this.builder=e,this.type=SoupType.Tag}build(t){if(!t||t.length<1)return this;let e=this;for(let n=0;n<t.length;++n){const r=this.transform(t[n]);e.nextElement=r,r.previousElement=e,e=r instanceof SoupTag?r.build(t[n].children):r,this.appendContents(r)}return e}transform(t){return t?"text"===t.type?new SoupString(t.data,this):"comment"===t.type?new SoupComment(t.data,this):"directive"===t.type&&"!DOCTYPE"===t.name?new SoupDoctypeString(t.data,this):new SoupTag(t.name,this.builder,t.attribs,this):null}appendContents(t){t&&this.contents.push(t)}find(t){const e=this.findAll(Object.assign(Object.assign({},t),{limit:1}));if(e.length>0)return e[0]}findAll(t){const e=[],n=new SoupStrainer(t),r=null==t.recursive||null==t.recursive?this.descendants:this.contents;for(let i=0;i<r.length;++i)if(r[i]instanceof SoupElement){const s=n.match(r[i]);if(s&&e.push(s),t.limit&&e.length>=t.limit)break}return e}unique_includes(t){let e=[];for(let n=0;n<t.length;n++)e.includes(t[n])||e.push(t[n]);return e}selectChild(t,e,n){var r,i,s;const a=t.split(",").filter((t=>t));let l=[];for(let t=0;t<a.length;t++){const o=a[t];if(o.startsWith("#"))l=l.concat(e.findAll({attrs:{id:o.slice(1)},recursive:n}));else if(o.startsWith(".")){const t=o.split(".").filter((t=>t)),i=e.findAll({attrs:{class:t[0]},recursive:n});for(let e=0;e<i.length;e++){const n=i[e],s=(null===(r=n.attrs.class)||void 0===r?void 0:r.split(" "))||[];t.every((t=>s.includes(t)))&&l.push(n)}}else if(o.includes(".")){const t=o.split(".").filter((t=>t)),r=e.findAll({name:t[0],recursive:n});for(let e=0;e<r.length;e++){const n=r[e],s=((null===(i=n.attrs.class)||void 0===i?void 0:i.split(" "))||[]).filter((t=>t));t.every((t=>s.includes(t)))&&l.push(n)}}else if(o.includes("#")){const t=o.split("#").filter((t=>t)),r=e.findAll({name:t[0],recursive:n});for(let e=0;e<r.length;e++){const n=r[e],i=((null===(s=n.attrs.id)||void 0===s?void 0:s.split(" "))||[]).filter((t=>t));t.every((t=>i.includes(t)))&&l.push(n)}}else l=l.concat(e.findAll({name:o,recursive:n}))}return l}matchSibling(t,e){var n,r,i,s;const a=t.split(",").filter((t=>t));for(let t=0;t<a.length;t++){const l=a[t];if(l.startsWith("#")){if(((null===(n=e.attrs.id)||void 0===n?void 0:n.split(" "))||[]).includes(l.slice(1)))return e}else if(l.startsWith(".")){const t=l.split(".").filter((t=>t)),n=(null===(r=e.attrs.class)||void 0===r?void 0:r.split(" "))||[];if(t.every((t=>n.includes(t))))return e}else if(l.includes(".")){const t=l.split(".").filter((t=>t)),n=(null===(i=e.attrs.class)||void 0===i?void 0:i.split(" "))||[];if(e.name==t[0]&&t.every((t=>n.includes(t))))return e}else if(l.includes("#")){const t=l.split("#").filter((t=>t)),n=(null===(s=e.attrs.id)||void 0===s?void 0:s.split(" "))||[];if(e.name==t[0]&&t.every((t=>n.includes(t))))return e}else if(e.name==l)return e}}select(t){var e;const n=null===(e=null==t?void 0:t.split(" "))||void 0===e?void 0:e.filter((t=>t));if(!n||!n.length)throw"selector param error!";let r={},i="",s=0;return n.forEach(((t,e)=>{if(0==e)r[e]=this.selectChild(t,this),s++;else if([">","~","+"].some((e=>t==e)))i=t;else{let e=[];">"==i?r[s-1].forEach((n=>{e=e.concat(this.selectChild(t,n,!1))})):"~"==i?r[s-1].forEach((n=>{const r=n.nextSiblings;if(r)for(let n=0;n<r.length;n++){const i=this.matchSibling(t,r[n]);i&&e.push(i)}})):"+"==i?r[s-1].forEach((n=>{const r=n.nextSiblings;if(r)for(let n=0;n<r.length;n++){const i=this.matchSibling(t,r[n]);if(i){e.push(i);break}}})):r[s-1].forEach((n=>{e=e.concat(this.selectChild(t,n))})),r[s]=e,i="",s++}})),this.unique_includes(r[s-1])}append(t){super.append(t);let e=this,n=this.nextElement;const r=t;let i=t;const s=t.descendants;s&&s.length>0&&(i=s[s.length-1]);const a=this.descendants;a&&a.length>0&&(e=a[a.length-1],n=e.nextElement),t.type!=SoupType.Text||e.type!=SoupType.Text?(r.previousElement=e,i.nextElement=n,e&&(e.nextElement=r),n&&(n.previousElement=i),this.contents.push(t),t.parent=this):e.text+=t.text}insert(t,e){if(super.insert(t,e),e.type==SoupType.Soup)return void e.contents.forEach((e=>{this.insert(t,e),++t}));if(t=Math.min(t,this.contents.length),"string"==typeof e&&(e=new SoupString(e)),e.parent){if(e.parent===this){let n=this.contents.indexOf(e);if(t==n)return;t>n&&--t}e.extract()}const n=this.contents.length,r=e.descendants,i=r&&r.length>0?r[r.length-1]:e;if(0==t)e.previousElement=this;else{const n=this.contents[t-1],r=n.descendants;e.previousElement=r&&r.length>0?r[r.length-1]:n}if(e.previousElement&&(e.previousElement.nextElement=e),t<n)i.nextElement=this.contents[t];else{let t=this,e=null;for(;!e&&t;)e=t.nextSibling,t=t.parent;i.nextElement=e||null}i.nextElement&&(i.nextElement.previousElement=i),e.parent=this,this.contents.splice(t,0,e)}}SoupTag.prototype.toString=function(){return this.prettify("","")};class TreeBuilder{constructor(){this.EMPTY_ELEMENT_TAGS=new Set(["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","basefont","bgsound","command","frame","image","isindex","nextid","spacer"])}canBeEmptyElement(t){return this.EMPTY_ELEMENT_TAGS.has(t)}}const ROOT_TAG_NAME="[document]";class BeautifulSoup extends SoupTag{constructor(t,e=!0){super("[document]",new TreeBuilder,null);const n=new htmlparser.DefaultHandler(((t,e)=>{t&&console.log(t)}),{verbose:!1,ignoreWhitespace:e});new htmlparser.Parser(n).parseComplete(t),Array.isArray(n.dom)?this.build(n.dom):this.build([n.dom]),this.hidden=!0,this.type=SoupType.Soup}}module.exports=BeautifulSoup;